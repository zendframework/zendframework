<?xml version="1.0" encoding="utf-8"?>
<!-- Converted by db4-upgrade version 1.0 -->

<section xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="zend.queue.framework"><info><title>Framework</title></info>
    

    <para>
        The <classname>Zend_Queue</classname> is a proxy that hides the details
        of the queue services. The queue services are represented by
        <classname>Zend_Queue_Adapter_&lt;service&gt;</classname>. For example,
        <classname>Zend_Queue_Adapter_Db</classname> is a queue that will use
        database tables to store and retrieve messages.
    </para>

    <para>
        Below is an example for using database tables for a queuing system:
    </para>

    <programlisting language="php">
$options = array(
    'name'          =&gt; 'queue1',
    'driverOptions' =&gt; array(
        'host'      =&gt; '127.0.0.1',
        'port'      =&gt; '3306',
        'username'  =&gt; 'queue',
        'password'  =&gt; 'queue',
        'dbname'    =&gt; 'queue',
        'type'      =&gt; 'pdo_mysql'
    )
);

// Create a database queue.
// Zend_Queue will prepend Zend_Queue_Adapter_ to 'Db' for the class name.
$queue = new Zend_Queue('Db', $options);
</programlisting>

    <para>
        The <classname>Zend_Queue</classname> constructor will create a
        <classname>Zend_Queue_Adapter_Db</classname> and initialize the adapter
        with the configuration settings.
    </para>

    <para>
        The accepted configuration settings for each adapter are provided
        in the <link linkend="zend.queue.adapters">adapter notes</link>.
    </para>

    <para>
        <classname>Zend_Queue</classname> returns messages using the class
        <classname>Zend_Queue_Message_Iterator</classname>, which is an
        implementation of <acronym>SPL</acronym> <classname>Iterator</classname> and
        <classname>Countable</classname>.
        <classname>Zend_Queue_Message_Iterator</classname> contains an array of
        <classname>Zend_Queue_Message</classname> objects.
    </para>

    <programlisting language="php">
$messages = $queue-&gt;receive(5);
foreach ($messages as $i =&gt; $message) {
    echo "$i) Message =&gt; ", $message-&gt;body, "\n";
}
</programlisting>

    <para>
        Any exceptions thrown are of class
        <classname>Zend_Queue_Exception</classname>.
    </para>

    <section xml:id="zend.queue.framework.basics"><info><title>Introduction</title></info>
        

        <para>
            <classname>Zend_Queue</classname> is a proxy class that represents
            an adapter.
        </para>

        <para>
            The <methodname>send()</methodname>,
            <methodname>count($queue)</methodname>, and
            <methodname>receive()</methodname> methods are employed by each
            adapter to interact with queues.
        </para>

        <para>
            The <methodname>createQueue()</methodname>,
            <methodname>deleteQueue()</methodname> methods are used to manage
            queues.
        </para>
    </section>

    <section xml:id="zend.queue.framework.support"><info><title>Commonality among adapters</title></info>
        

        <para>
            The queue services supported by <classname>Zend_Queue</classname> do
            not all support the same functions. For example,
            <classname>Zend_Queue_Adapter_Array</classname>,
            <classname>Zend_Queue_Adapter_Db</classname>, support all functions,
            while <classname>Zend_Queue_Adapter_Activemq</classname> does not
            support queue listing, queue deletion, or counting of messages.
        </para>

        <para>
            You can determine what functions are supported by using
            <methodname>Zend_Queue::isSupported()</methodname> or
            <methodname>Zend_Queue::getCapabilities()</methodname>.
        </para>

        <itemizedlist>
            <listitem>
                <para>
                    <emphasis><methodname>createQueue()</methodname></emphasis> - create a queue
                </para>
            </listitem>

            <listitem>
                <para>
                    <emphasis><methodname>deleteQueue()</methodname></emphasis> - delete a queue
                </para>
            </listitem>

            <listitem>
                <para>
                    <emphasis><methodname>send()</methodname></emphasis> - send a message
                </para>

                <para>
                    <methodname>send()</methodname> is not available in all adapters; the
                    <classname>Zend_Queue_Adapter_Null</classname> does not
                    support <methodname>send()</methodname>.
                </para>
            </listitem>

            <listitem>
                <para>
                    <emphasis><methodname>receive()</methodname></emphasis> - receive messages
                </para>

                <para>
                    <methodname>receive()</methodname> is not available in all adapters;
                    the <classname>Zend_Queue_Adapter_Null</classname> does not
                    support <methodname>receive()</methodname>.
                </para>
            </listitem>

            <listitem>
                <para>
                    <emphasis><methodname>deleteMessage()</methodname></emphasis> - delete a
                    message
                </para>
            </listitem>

            <listitem>
                <para>
                    <emphasis><methodname>count()</methodname></emphasis> - count the number of
                    messages in a queue
                </para>
            </listitem>

            <listitem>
                <para>
                    <emphasis><methodname>isExists()</methodname></emphasis> - checks the existence
                    of a queue
                </para>
            </listitem>
        </itemizedlist>

        <para>
            <methodname>receive()</methodname> methods are employed by each
            adapter to interact with queues.
        </para>

        <para>
            The <methodname>createQueue()</methodname> and
            <methodname>deleteQueue()</methodname> methods are used to manage
            queues.
        </para>
    </section>
</section>
